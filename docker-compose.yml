version: "3.8"

services:
  mysql:
    image: mysql:8.0
    expose:
      - '3306'
    # needed for testing mysql service independently, but omit for building container with go app
    #ports:
    #  - '3307:3306' # (host:container)
    container_name: mysql_container
    restart: always
    environment:
      MYSQL_ROOT_PASSWORD: 'rootpassword'  # Hardcoded credentials
      MYSQL_DATABASE: 'nbaoverunders' 
      MYSQL_USER: 'web2' 
      MYSQL_PASSWORD: 'mypassword' # this is not the real password web2 has in MySQL
  app:
    build:
      context: .
      dockerfile: dockerfile
    ports:
      - "4000:4000"
    depends_on:
      - mysql
    environment:
      DB_HOST: 'mysql'

# docker compose -f docker-compose.yml up --build
# after changes: docker compose down -v
# separate terminal: mysql -h 127.0.0.1 -P 3307 -u web2 -p

# reference: https://www.youtube.com/watch?v=p0n90IUfjp4